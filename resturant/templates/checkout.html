{% extends 'base.html' %}
{% block content %}
  {% if order %}
    <div class="container">
      <h2>Order #{{ order.pk }}</h2>
      <div class="row">
        <div class="col-md-6">
          <p>Status: {{ order.status }}</p>
          <p>Date Placed: {{ order.date_placed|date:"F j, Y P" }}</p>
        </div>
      </div>

      <h3>Order Items</h3>
      <table class="table table-bordered">
        <thead class="thead-dark">
          <tr>
            <th>Quantity</th>
            <th>Name</th>
            <th>Price</th>
            <th>Sub total</th>
          </tr>
        </thead>
        <tbody>
          {% for order_item in order_items %}
            <tr>
              <td>{{ order_item.quantity }}</td>
              <td><a href="{% url 'home'%}?item_id={{order_item.item.pk}}">{{ order_item.item.title }}</a></td>
              <td>${{ order_item.item.price }}</td>
              <td>${{ order_item.sub_total }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>

      <p class="lead">Total Price: ${{ order.order_total }}</p>

      {% if order.status == 'completed' %}
        <p class="lead">Completed: {{ order.action_timestamp|date:"F j, Y P" }}</p>
      {% elif order.status == 'cancelled' %}
        <p class="lead">Cancelled: {{ order.action_timestamp|date:"F j, Y P" }}</p>
      {% endif %}
    </div>
  {% else %}
    <div class="container">
      {% if orders %}
        <h2>Your Orders</h2>
        <ul class="list-group">
          {% for order in orders %}
            <li class="list-group-item">
              Order #{{ order.pk }}
              - <a href="{% url 'order_details' %}?order_pk={{ order.pk }}">View Details</a>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p>No previous orders found.</p>
      {% endif %}
    </div>
  {% endif %}
{% endblock %}
